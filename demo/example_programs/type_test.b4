global bool shift false

def get_keypress() -> u16
  var u16 kbd 8192
  var u16 scancode *kbd
  var u16 char_code 0

  while scancode > 0
    if scancode == 0xAA
      //pass
    else if scancode == 0xF0
      scancode = *kbd
      if scancode == 0x12
        shift = false
    else if scancode == 0xE0
      //pass
    else if scancode == 0x12
      shift = true
    else
      char_code = sys.kbd.scancode_to_charcode(scancode,shift)
      return char_code
    scancode = *kbd

  return char_code

var u16 x
var u16 y
var u16 code
var u16 temp
var bool draw_cursor true
sys.vram.render_char(128,x,y)

while true
  code = get_keypress()

  if code == 0
    if draw_cursor
      sys.vram.render_char(128,x,y)
      draw_cursor = false
  else
    draw_cursor = true

    if code == 8
      if y < 15
        sys.vram.render_char(32,x,y,false)
        x = 0
        y++
    else if code == 1
      temp = x + y
      if temp > 0
        sys.vram.render_char(32,x,y,false)
        if x > 0
          x--
        else
          x = 15
          y--
    else
      sys.vram.render_char(code,x,y,false)
      x++
      if x > 15
        x = 0
        y++
